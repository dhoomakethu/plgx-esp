<style>
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  -webkit-transition: all 0.3s;
  -moz-transition: all 0.3s;
  transition: all 0.3s;
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
.dropbtn {
  background-color: #4CAF50;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: none;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;

}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {background-color: #ddd;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
</style>
<div class="kt-grid kt-grid--hor kt-grid--root">
  <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--ver kt-page">
    <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor kt-wrapper" id="kt_wrapper">
      <div class="kt-portlet kt-portlet--mobile kt-portlet--responsive-mobile" style="margin-bottom: 0px;">
        <div class="kt-portlet__head kt-portlet__head--lg">
          <div class="kt-portlet__head-label">
            <span class="kt-portlet__head-icon">
              <i class="kt-font-brand fa fa-th-list "></i>
              <a href="/hosts" class="" data-toggle="kt-tooltip" title="Back to Nodes">
              </a>
            </span>
            <h1 class="kt-portlet__head-title" style="font-size: 20px;">
              {{node_info?.computer_name}} /
              <a class="routerLink_Font_colour"[routerLink]="['../',this.id,'activity']" data-skin="dark" data-toggle="kt-tooltip"
                data-placement="top" title="click -> Activity for recent Node ">recent activity</a>
            </h1>

          </div>

          <div class="kt-portlet__head-toolbar">
            <div class="kt-portlet__head-wrapper">
              <div class="">
                <a  (click)="goBack()" class="btn btn-clean btn-sm" data-skin="dark"
                  data-toggle="kt-tooltip" data-placement="top" title="Back to Previous Page">
                  <i class="fas fa-chevron-left"></i>
                  Back
                </a>
              </div>
            </div>
          </div>

        </div>
        <div class="kt-portlet__body" >
          <!-- Begin:: Portlet/tab -->
          <div class="kt-portlet">
           <div class="kt-portlet__body py-2">
            <div class="row">
              <div class="col-lg-9">
              <ul class="nav nav-tabs nav-tabs-line nav-tabs-line-success" role="tablist">
                <li class="nav-item">
                  <a class="nav-link active" data-toggle="tab" href="#host_details" role="tab">Details</a>
                </li>

                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#network_information" role="tab">Network Info</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#additional_packs_query_tags" role="tab">Tags
                    </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#status_log" (click)="status_log_tab()" role="tab">Status Log</a>
                </li>
                  <!-- <li class="nav-item">

                           <select (change)="onOptionsSelected($event)" [(ngModel)]="actionselect"  class="btn btn-primary dropdown-toggle" style='margin-left: 550px;width: 90px;padding-top:4px;padding-bottom:4px'>
                            <option hidden Value="0">Action</option>
                            <option Value="1">Config
                            </option>
                            <option *ngIf="responseenabled == true && endpoint == true" value="2">Restart Agent</option>
                             <option *ngIf="endpoint == true && responseenabled == false" value="3">Restart Agent</option>
                          </select>

                </li> -->
              </ul>
             </div>
             <div class="col-lg-3 pr-0">
               <div class="dropdown" style='float:right'>
                  <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style='width: 90px;padding-top:4px;padding-bottom:4px'>
                    Action
                  </button>
                  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="min-width:90px">
                    <a class="dropdown-item" style="cursor:pointer;padding-top:5px !important;padding-bottom:5px !important" (click)="onselectoption(1)">View Config</a>
                  </div>
              </div>
             </div>
           </div>
              <div class="tab-content">
                <div class="tab-pane active" id="host_details" role="tabpanel">
                  <!--begin:: Host Details -->
                  <div id="kt_form" class="kt-form form-horizontal" method="POST">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="row">
                          <!-- <i class="fa fa-user" aria-hidden="true" style="margin: 9px;color: #0000ffc7;margin-right:5px" data-toggle="tooltip" title="Host Name"></i>
                          <div class="col-md-2 col-form-label form--p" data-toggle="tooltip" title="Host Name">
                            {{node_info?.computer_name}}
                          </div> -->
                          <i class="fa fa-user host_name fnt-green" aria-hidden="true"  data-toggle="tooltip" title="Host Name"></i>
                          <div class="dropdown col-md-2 col-form-label form--p" style="margin-top:-10px">
                           <div class="col-md-12 col-form-label form--p overflow" >
                            <span>{{node_info?.computer_name}}</span>
                          </div>
                          <div class="dropdown-content" style="width:430px">
                            <a class="sub_menu_wd">Host Name<b>: </b>{{node_info?.computer_name}}</a>
                            <a class="sub_menu_wd">Host Identifier<b>: </b>{{host_identifier }}</a>
                          </div>
                        </div>

                          <i class="fa fa-laptop hw_mdl fnt-green" aria-hidden="true" data-toggle="tooltip" title="Make & Model"></i>
                          <div class="col-md-2 col-form-label form--p overflow" data-toggle="tooltip" title="Make & Model" >
                            <span>{{node_info?.hardware_vendor}}<b>-</b>{{node_info?.hardware_model}}</span>
                          </div>

                          <i class="fa fa-microchip cpu_cores fnt-green" aria-hidden="true" data-toggle="tooltip" title="CPU Cores"></i>
                          <div class="col-md-2 col-form-label form--p" data-toggle="tooltip" title="CPU Cores">
                            Cpu Cores<b>-</b>{{node_info?.cpu_physical_cores}}
                          </div>

                         <div class="col-md-4 mt-2">
                          <span *ngIf="os_platform == 'ubuntu'" class='logo-color menu-icon'
                            style='font-weight: 400;margin-top:5px' data-toggle="tooltip" title="Operating System">
                            <img alt='' src='./assets/media/logo/Linux1.svg' height='19px' width='16px'/>
                            <span>&ensp;{{os_name}}</span>
                          </span>
                          <span *ngIf="os_platform == 'windows'" class='logo-color menu-icon'
                            style='font-weight: 400;margin-top:5px' data-toggle="tooltip" title="Operating System">
                            <img alt='' src='./assets/media/logo/windows.svg' height='19px' width='16px' />
                            <span>&ensp;{{os_name}}</span>
                          </span>
                          <span *ngIf="os_platform == 'darwin'" class='logo-color menu-icon'
                            style='font-weight: 400;margin-top:5px' data-toggle="tooltip" title="Operating System">
                            <i class='fab fa-apple' style='font-size: 18px; color: #8e8e93;'></i>
                            <span>&ensp;{{os_name}}</span>
                          </span>
                          <span *ngIf="os_platform == 'rhel'" class='logo-color menu-icon'
                            style='font-weight: 400;margin-top:5px' data-toggle="tooltip" title="Operating System">
                            <img alt='' src='./assets/media/logo/Linux1.svg' height='19px' width='16px'/>
                            <span>&ensp;{{os_name}}</span>
                          </span>
                          <span *ngIf="os_platform == 'debian'" class='logo-color menu-icon' style='font-weight: 400;margin-top:5px' data-toggle="tooltip" title="Operating System">
                            <img alt='' src='./assets/media/logo/Linux1.svg' height='19px' width='16px' />
                            <span>&ensp;{{os_name}}</span>
                          </span>

                          <span *ngIf="os_platform == 'sles'" class='logo-color menu-icon' style='font-weight: 400;margin-top:5px' data-toggle="tooltip" title="Operating System">
                            <img alt='' src='./assets/media/logo/Linux1.svg' height='19px' width='16px' />
                            <span>&ensp;{{os_name}}</span>
                          </span>

                          <span *ngIf="os_platform == 'amzn'" class='logo-color menu-icon' style='font-weight: 400;margin-top:5px' data-toggle="tooltip" title="Operating System">
                            <img alt='' src='./assets/media/logo/Linux1.svg' height='19px' width='16px' />
                            <span>&ensp;{{os_name}}</span>
                          </span>
                         </div>
                        </div>
                           <div class="row">
                            <i class="fa fa-memory ph_memory fnt-green" aria-hidden="true" data-toggle="tooltip" title="Memory"></i>
                          <div class="col-md-2 col-form-label form--p" data-toggle="tooltip" title="Memory">
                            {{physical_memory}}
                          </div>

                          <img alt='' src='./assets/media/IP_Icon.png' height='23px' width='23px' class="last_ip" data-toggle="tooltip" title="Last IP Address"/>
                          <div class="col-md-2 col-form-label form--p" data-toggle="tooltip" title="Last IP Address">
                               {{this.nodes?.last_ip}}
                          </div>

                          <i class="fa fa-calendar enrolled fnt-green" aria-hidden="true" data-toggle="tooltip" title="Agent Enrolled"></i>
                          <div class="col-md-2 col-form-label form--p" data-toggle="tooltip" title="Agent Enrolled">
                            Enrolled<b>:</b> {{this.enrolled | date}}
                          </div>

                        <i class="fa fa-align-justify serial fnt-green" aria-hidden="true" data-toggle="tooltip" title="Serial No."></i>
                        <div class="col-md-4 col-form-label form--p" data-toggle="tooltip" title="Serial No.">
                         {{node_info?.hardware_serial}}
                        </div>

                        </div>
                          <div class="row" style="margin-top:5px">

                          <img src="https://blog.rapid7.com/content/images/kk-img/2016/05/logo-osquery.png" data-toggle="tooltip" title="Osquery Version" class="qr_version">
                          <div class="col-md-2 col-form-label form--p" data-toggle="tooltip" title="Osquery Version">
                            {{hostDetails['osquery_version']}}
                          </div>

                          <img src="../assets/media/eiq-img/logo.svg" data-toggle="tooltip" title="{{ProjectName}} Agent Version" class="ex_version">
                          <div class="col-md-2 col-form-label form--p" data-toggle="tooltip" title="{{ProjectName}} Agent Version">
                            {{hostDetails['extension_version']}}
                          </div>

                         <i class="fa fa-clock lastseen fnt-green" aria-hidden="true" ></i>
                         <div class="dropdown" style='width: 205px;'>
                          <div class="col-md-12 col-form-label form--p" >
                          <p>Last Seen<b>:</b> {{this.lastcheckin | dateAgo}}</p>
                         </div>
                         <div class="dropdown-content lastseen_menu">
                           <a class="sub_menu_wd">Last Status<b>:</b> {{this.laststatus | dateAgo}}</a>
                           <a class="sub_menu_wd">Last Query Read<b> :</b> {{this.lastqueryread | dateAgo}}</a>
                           <a class="sub_menu_wd">Last Query Write<b> :</b> {{this.lastquerywrite | dateAgo }}</a>
                           <a class="sub_menu_wd">Last Config<b>:</b> {{this.lastconfig | dateAgo }}</a>
                           <a class="sub_menu_wd">Last Result<b>:</b>  {{this.lastresult | dateAgo }}</a>
                         </div>
                       </div>

                        </div>
                        </div>
                    </div>
                  </div>
                  <!--end:: Host Details -->

                  <div class="kt-portlet mt-4">
                   <!--start chart-->
                   <div class="row ml-3 mt-4">

                    <div class="row col-xs-12 col-md-6 col-lg-6 col-xl-6" >

                       <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                         <!--begin:: AlienVault OTX Alerts -->
                         <div class="otx_counter_val" >
                           <a *ngIf="alienvault.TOTAL>0" [routerLink]="['../',this.id,'alerts']"  [queryParams]="{id:'alienvault'}"  id="div_alienvault">
                           <div class="kt-portlet kt-portlet--border-bottom-success" style="border-bottom: 3px solid rgb(110, 190, 68);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-otx" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                   <div class="row">
                                     <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                           <span  class="kt-widget26__number" id="otx_counter" style="color: #78c351;"></span>
                                            <!-- <ng-template #otx_counter_val> -->
                                            <span id="otx_counter" class="kt-widget26__number" style="color: #78c351;">{{alienvault.TOTAL}}</span>
                                           <!-- </ng-template> -->
                                           <span class="kt-widget26__desc text-overlap-text" style="">AlienVault</span>
                                       </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/AlienVaultOTX.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                   <!--begin:: AlienVault OTX Severity -->
                                   <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                     <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="alienvault_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{alienvault.CRITICAL}}
                                            </span>
                                         </div>
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                           <span id="alienvault_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                             {{alienvault.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                           <span  id="alienvault_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                             {{alienvault.LOW}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: navy;">Info</span>
                                           <span  id="alienvault_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{alienvault.INFO}}
                                           </span>
                                       </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                  <!--end:: AlienVault OTX Severity -->
                                 </div>
                              </div>
                            </div>
                           </a>
                         </div>
                         <div class="otx_counter_val" >
                          <a *ngIf="alienvault.TOTAL==0"  id="div_alienvault">
                          <div class="kt-portlet kt-portlet--border-bottom-success" style="border-bottom: 3px solid rgb(110, 190, 68);">
                             <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-otx" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                               <div class="kt-widget26 text-overlap">
                                  <div class="row">
                                    <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                       <div class="kt-widget26__content align-top-alerts ">
                                          <span  class="kt-widget26__number" id="otx_counter" style="color: #78c351;"></span>
                                           <!-- <ng-template #otx_counter_val> -->
                                           <span id="otx_counter" class="kt-widget26__number" style="color: #78c351;">{{alienvault.TOTAL}}</span>
                                          <!-- </ng-template> -->
                                          <span class="kt-widget26__desc text-overlap-text" style="">AlienVault</span>
                                      </div>
                                   </div>
                                   <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                     <img class="text-overlap-img" src="./assets/media/AlienVaultOTX.png" height="60px" width="60px" style="opacity: 0.5" />
                                   </div>
                                 </div>
                               </div>
                               <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <!--begin:: AlienVault OTX Severity -->
                                  <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                    <div class="row">
                                       <div class="col">
                                         <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: red;">Critical</span>
                                           <span  id="alienvault_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                               {{alienvault.CRITICAL}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                          <span id="alienvault_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                            {{alienvault.WARNING}}
                                       </span>
                                       </div>
                                       <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                          <span  id="alienvault_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                            {{alienvault.LOW}}
                                          </span>
                                       </div>
                                       <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: navy;">Info</span>
                                          <span  id="alienvault_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                             {{alienvault.INFO}}
                                          </span>
                                      </div>
                                     <!-- </ng-container> -->
                                     </div>
                                   </div>
                                 </div>
                                 <!--end:: AlienVault OTX Severity -->
                                </div>
                             </div>
                           </div>
                          </a>
                        </div>
                         <!--end:: AlienVault OTX Alerts -->
                       </div>

                       <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                       <!--begin:: IBMxForce Alerts -->
                         <div class="ibm_counter_val" >
                           <a *ngIf="ibmxforce.TOTAL>0" [routerLink]="['../',this.id,'alerts']"  [queryParams]="{id:'ibmxforce'}">
                           <div class="kt-portlet kt-portlet--border-bottom-danger" style="border-bottom: 3px solid rgb(145, 217, 247);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-ibm" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                   <div class="row">
                                     <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                            <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                            <span id="ibm_counter" class="kt-widget26__number" style="color: #91d9f6;">{{ibmxforce.TOTAL}}</span>
                                           <span class="kt-widget26__desc text-overlap-text" style="width:100px">IBM X-Force Alerts</span>
                                       </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/IBMxForce.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                   <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                     <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="ibmxforce_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{ibmxforce.CRITICAL}}
                                            </span>
                                         </div>
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                           <span id="ibmxforce_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                             {{ibmxforce.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                           <span  id="ibmxforce_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                             {{ibmxforce.LOW}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: navy;">Info</span>
                                           <span  id="ibmxforce_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{ibmxforce.INFO}}
                                           </span>
                                       </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                 </div>
                              </div>
                            </div>
                           </a>
                         </div>
                         <div class="ibm_counter_val" >
                          <a *ngIf="ibmxforce.TOTAL==0"  id="div_ibmxforce">
                          <div class="kt-portlet kt-portlet--border-bottom-danger" style="border-bottom: 3px solid rgb(145, 217, 247);">
                             <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-ibm" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                               <div class="kt-widget26 text-overlap">
                                  <div class="row">
                                    <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                       <div class="kt-widget26__content align-top-alerts ">
                                           <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                           <span id="ibm_counter" class="kt-widget26__number" style="color: #91d9f6;">{{ibmxforce.TOTAL}}</span>
                                          <span class="kt-widget26__desc text-overlap-text" style="width:100px">IBM X-Force Alerts</span>
                                      </div>
                                   </div>
                                   <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                     <img class="text-overlap-img" src="./assets/media/IBMxForce.png" height="60px" width="60px" style="opacity: 0.5" />
                                   </div>
                                 </div>
                               </div>
                               <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                    <div class="row">
                                       <div class="col">
                                         <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: red;">Critical</span>
                                           <span  id="ibmxforce_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                               {{ibmxforce.CRITICAL}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                          <span id="ibmxforce_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                            {{ibmxforce.WARNING}}
                                       </span>
                                       </div>
                                       <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                          <span  id="ibmxforce_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                            {{ibmxforce.LOW}}
                                          </span>
                                       </div>
                                       <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: navy;">Info</span>
                                          <span  id="ibmxforce_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                             {{ibmxforce.INFO}}
                                          </span>
                                      </div>
                                     <!-- </ng-container> -->
                                     </div>
                                   </div>
                                 </div>
                                </div>
                             </div>
                           </div>
                          </a>
                        </div>
                         <!--end::IBMxForce Alerts -->
                       </div>

                       <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                       <!--begin:: IBMxForce Alerts -->
                         <div class="rule_counter_val" >
                          <a  *ngIf="rule.TOTAL>0"[routerLink]="['../',this.id,'alerts']" [queryParams]="{id:'rule'}" preserveQueryParams="true" id="div_rule">
                           <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(229, 87, 86, 0.81);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                   <div class="row">
                                     <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                            <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                            <span id="ibm_counter" class="kt-widget26__number" style="color: #e87373">{{rule.TOTAL}}</span>
                                           <span class="kt-widget26__desc text-overlap-text" style="width:100px">Rule Alerts</span>
                                       </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                   <!--begin:: AlienVault OTX Severity -->
                                   <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                     <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="rule_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{rule.CRITICAL}}
                                            </span>
                                         </div>
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                           <span id="rule_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                             {{rule.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                           <span  id="rule_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                             {{rule.LOW}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: navy;">Info</span>
                                           <span  id="rule_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{rule.INFO}}
                                           </span>
                                       </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                  <!--end:: AlienVault OTX Severity -->
                                 </div>
                              </div>
                            </div>
                           </a>
                         </div>
                         <div class="rule_counter_val" >
                          <a  *ngIf="rule.TOTAL==0" id="div_rule">
                           <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(229, 87, 86, 0.81);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                   <div class="row">
                                     <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                            <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                            <span id="ibm_counter" class="kt-widget26__number" style="color: #e87373">{{rule.TOTAL}}</span>
                                           <span class="kt-widget26__desc text-overlap-text" style="width:100px">Rule Alerts</span>
                                       </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                   <!--begin:: AlienVault OTX Severity -->
                                   <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                     <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="rule_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{rule.CRITICAL}}
                                            </span>
                                         </div>
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                           <span id="rule_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                             {{rule.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                           <span  id="rule_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                             {{rule.LOW}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: navy;">Info</span>
                                           <span  id="rule_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{rule.INFO}}
                                           </span>
                                       </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                  <!--end:: AlienVault OTX Severity -->
                                 </div>
                              </div>
                            </div>
                           </a>
                         </div>
                         <!--end:: AlienVault OTX Alerts -->
                       </div>

                       <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                       <!--begin:: VirusTotal Alerts -->
                         <div class="vt_counter_val" >
                           <a  *ngIf="virustotal.TOTAL>0" [routerLink]="['../',this.id,'alerts']" [queryParams]="{id:'virustotal'}"  id="div_virustotal">
                           <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgb(60, 95, 246);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-virus" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                   <div class="row">
                                     <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                            <span id="vt_counter" class="kt-widget26__number" style="color: #3c5ff6">{{virustotal.TOTAL}}</span>
                                           <span class="kt-widget26__desc text-overlap-text" style="">VirusTotal Alerts</span>
                                       </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/VirusTotal.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                   <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                     <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="virustotal_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{virustotal.CRITICAL}}
                                            </span>
                                         </div>
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                           <span id="virustotal_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                             {{virustotal.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                           <span  id="virustotal_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                             {{virustotal.LOW}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: navy;">Info</span>
                                           <span  id="virustotal_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{virustotal.INFO}}
                                           </span>
                                       </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                 </div>
                              </div>
                            </div>
                           </a>
                         </div>
                         <div class="vt_counter_val" >
                          <a  *ngIf="virustotal.TOTAL==0"  id="div_virustotal">
                          <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgb(60, 95, 246);">
                             <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-virus" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                               <div class="kt-widget26 text-overlap">
                                  <div class="row">
                                    <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                       <div class="kt-widget26__content align-top-alerts ">
                                           <span id="vt_counter" class="kt-widget26__number" style="color: #3c5ff6">{{virustotal.TOTAL}}</span>
                                          <span class="kt-widget26__desc text-overlap-text" style="">VirusTotal Alerts</span>
                                      </div>
                                   </div>
                                   <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                     <img class="text-overlap-img" src="./assets/media/VirusTotal.png" height="60px" width="60px" style="opacity: 0.5" />
                                   </div>
                                 </div>
                               </div>
                               <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                    <div class="row">
                                       <div class="col">
                                         <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                         <div class="kt-widget15__item">
                                           <span class="kt-widget15__text" style="color: red;">Critical</span>
                                           <span  id="virustotal_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                               {{virustotal.CRITICAL}}
                                           </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                          <span id="virustotal_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                            {{virustotal.WARNING}}
                                       </span>
                                       </div>
                                       <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                          <span  id="virustotal_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                            {{virustotal.LOW}}
                                          </span>
                                       </div>
                                       <div class="kt-widget15__item">
                                          <span class="kt-widget15__text" style="color: navy;">Info</span>
                                          <span  id="virustotal_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                             {{virustotal.INFO}}
                                          </span>
                                      </div>
                                     <!-- </ng-container> -->
                                     </div>
                                   </div>
                                 </div>
                                </div>
                             </div>
                           </div>
                          </a>
                        </div>
                         <!--end:: VirusTotal Alerts -->
                       </div>

                    </div>

                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6">
                      <!--begin::Portlet-->
                      <div class="kt-portlet mb-0">
                        <div class="kt-portlet__head" style="min-height:35px">
                          <div class="kt-portlet__head-label">
                            <span class="kt-portlet__head-icon kt-hidden">
                              <i class="la la-gear"></i>
                            </span>
                            <h4 class="kt-portlet__head-title Kt-lbl-sz">
                              Top Alerting Rules on {{node_info?.computer_name}}
                            </h4>
                          </div>
                        </div>
                        <div id="divchart1">
                          <div id="top_rules" >
                          <canvas id="alerted_rules" class="top_rules" style="height:230px;width:100%"></canvas>
                        </div>
                          <div id="no-data-bar-chart-top_5_alerted_rules" style="margin-left: 50px; margin-top: 40px;"></div>
                        </div>

                      </div>
                      <!--end::Portlet-->
                    </div>

                   </div>
                   <!--end chart-->
                  </div>
                </div>


                 <!--Begin:: Modal-->


  <div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display: none;z-index: 10000; position: fixed; background-color: hsla(0, 0%, 0%, 0.45)" >
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content"  style='margin-top: -95px;width: 800px;'>
        <div class="modal-header">
          <!-- <h3 class="">Alerted Entry</h3> -->
          <span id="stitle">Configuration</span>
          <h3 class=""></h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="close()"></button>

        </div>
        <div class="modal-body kt-scroll" data-scroll="false" data-height="200" data-scrollbar-shown="true">
          <!--begin:: Widgets/Tasks -->

          <form class="kt-form" id="kt_form">
            <div class="row">
               <!-- <div class="col-xl-2"></div> -->
              <div class="col-xl-12">
                <div class="kt-section kt-section--first">
                  <div class="kt-section__body">
                    <div class="" *ngIf="toggle">
                      <json-editor class="col-md-12" style="min-height: 300px;" [options]="editorOptions" [data]="alerted_data_json"></json-editor>
                      </div>
                    </div>

                </div>
                <!-- <div class="kt-separator kt-separator--border-dashed kt-separator--space-lg"></div> -->
              </div>
              <div class="col-xl-2"></div>
            </div>
          </form>
          <!--end:: Widgets/Tasks -->
        </div>
        <div class="modal-footer align-center">
          <button type="button" (click)="close()" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <!--End:: Modal-->

                <div class="tab-pane" id="network_information" role="tabpanel">
                  <!--begin:: Network Information -->
                  <div id="kt_form" class="kt-form form-horizontal table-responsive" method="POST">
                    <table class="table table-striped- table-bordered table-hover table-checkable ">
                      <thead>
                        <tr>
                          <th>Mac</th>
                          <th>Mask</th>
                          <th>Address</th>
                          <th>Enabled</th>
                          <th>Description</th>
                          <th>Manufacturer</th>
                          <th>Connection_id</th>
                          <th>Connection_status</th>
                        </tr>
                      </thead>
                      <tbody *ngIf="network_info !=null">
                        <tr *ngFor="let networkdata of network_info">
                          <td> {{networkdata.mac}} </td>
                          <td> {{networkdata.mask}} </td>
                          <td> {{networkdata.address}} </td>
                          <td> {{networkdata.enabled}} </td>
                          <td> {{networkdata.description}} </td>
                          <td> {{networkdata.manufacturer}} </td>
                          <td> {{networkdata.connection_id}} </td>
                          <td> {{networkdata.connection_status}} </td>
                        </tr>
                      </tbody>
                    </table>
                    <div *ngIf="network_info ==null" style="text-align: center;">No results</div>
                  </div>
                  <!--end:: Network Information -->
                </div>
                <div class="tab-pane" id="status_log" role="tabpanel">
                  <!--begin:: Status Log  -->
                  <div style="float: right;padding-right:25px; padding-bottom:10px;">
                    <input *ngIf="status_log_checkbox == false" class="checkboxClass" (change)="toggleEditable($event)" name="status" type="checkbox" >
                    <input  *ngIf="status_log_checkbox == true" id="status" class="checkboxClass" (change)="toggleEditable($event)" name="status" type="checkbox" checked >&nbsp;<span> Show Status Log</span>
                  </div>
                  <div  *ngIf="status_log_checkbox == true " id="kt_form" class="kt-form form-horizontal" method="POST">
                    <table datatable [dtOptions]="dtOptions"
                      class="table table-hover table-checkable response_table row-border hover" id="response_table"
                      style="margin-left: 0px; width: 1039px;">
                      <thead>
                        <tr>
                          <th>Line</th>
                          <th>Message</th>
                          <th>Severity</th>
                          <th>File Name</th>
                          <th>Created At</th>
                          <th>Version</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let statuslog of log_data">
                          <td> {{statuslog.line}} </td>
                          <td> {{statuslog.message}} </td>
                          <td> {{statuslog.severity}} </td>
                          <td> {{statuslog.filename}} </td>
                          <td> {{statuslog.created}} </td>
                          <td> {{statuslog.version}} </td>
                        </tr>
                      </tbody>
                    </table>
                    <div *ngIf="log_data?.length === 0">
                      <span style=" text-align: center; padding-left: 300px;font-size: larger;font-weight: 600;">
                        {{errorMessage}}
                      </span>
                    </div>
                    <!--end:: Status Log -->
                  </div>
                  <!--begin:: Additional/packs/query/tags -->

                </div>
                <div class="tab-pane" id="additional_packs_query_tags" role="tabpanel">
                    <!--Begin:: Tags -->
                    <div class="kt-portlet">
                      <div class="kt-portlet__body">

                        <h2 style="color:#616C9A">Tags</h2>
                        <div>
                          <tag-input [theme]="'foundation-theme'" [placeholder]="'Add tags here...'" [(ngModel)]='tags'
                            (onAdd)="hosts_addTag(tags,id)" (onRemove)="hosts_removeTag($event,id)"
                            [modelAsStrings]="true"></tag-input>
                        </div>
                      </div>
                    </div>
                    <!--End:: Tags -->
                  <!--begin:: Packs -->
                  <div class="kt-portlet">
                    <div class="kt-portlet__body">
                      <h2 style="color:#616C9A">Associated Packs</h2>
                      <!--Begin:: Content/Packs -->
                      <div *ngIf="packs_count != 0" class="row">
                        <div class="col-md-4">
                          <!--begin::Portlet-->
                          <div class="kt-portlet no-mar-botom portlet-body_align">
                            <div class="kt-portlet__body" style="padding: 0px;">
                              <!--begin: Search Table -->
                              <div class="">
                                <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
                                  <input type="text" class="form-control" placeholder="Search Packs here..."
                                    id="search_pack_query_name" [(ngModel)]="term">
                                  <span class="kt-input-icon__icon kt-input-icon__icon--left">
                                    <span><i class="la la-search"></i></span>
                                  </span>
                                </div>
                              </div>
                              <!--end: Search Table -->
                              <div class="" style="height: 575px; overflow-x: scroll;margin-bottom:25px;">

                                <div class="">
                                  <h3>General</h3>
                                  <!--begin::Notifications-->

                                  <div *ngFor="let pack of pack_name | filter:term" class="kt-notification conf-div"
                                    id="search_query-name-list" style="cursor:pointer;" data-skin="dark"
                                    data-toggle="kt-tooltip" data-placement="top" title="{{pack.name}}">
                                    <div class="kt-notification__item-title list-group" [ngClass]="{'active_data': selectedItem == pack.name}" (click)='getBy_packId(pack.name)' >
                                    <a data-target="{{pack.name}}" class="kt-notification__item conf-link">
                                      <!-- <div class="kt-notification__item-icon">
                               <i class="fa conf-icon {{pack.pack_icon()}}"></i>
                             </div> -->
                                      <div class="kt-notification__item-details">
                                        <div class="kt-notification__item-title">
                                          {{ pack.name }}
                                      </div>
                                      </div>
                                    </a>
                                    </div>
                                  </div>
                                  <!--End::Notifications-->
                                </div>
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                        <!-- <div class="kt-separator"></div> -->
                        <div class="col-md-8 right-content-conf">
                          <!--begin::Portlet-->
                          <div class="right-conf kt-portlet no-mar-botom portlet-body_align__table"
                            id="{{pack_data.name}}">
                            <div class="kt-portlet__head">
                              <div class="kt-portlet__head-label">
                                <span class="kt-portlet__head-icon">
                                </span>
                                <h3 class="kt-portlet__head-title">
                                  {{pack_data.name}}
                                </h3>
                              </div>
                            </div>
                            <div class="kt-portlet__body" style="padding:10px;">
                              <tag-input [theme]="'foundation-theme'" [placeholder]="'Add tags here...'"
                                [(ngModel)]='pack_data.tags' (onAdd)="pack_addTag(pack_data.tags,pack_data.id)"
                                (onRemove)="pack_removeTag($event,pack_data.id)" [modelAsStrings]="true"></tag-input>
                            </div>
                            <div class="kt-portlet__body"
                              style="height: 528px; overflow-x:scroll; padding:1.25rem; margin-bottom:20px;">
                              <div class="accordion accordion-solid" id="accordion-{{pack_data.id}}">
                                <!--begin::Portlet-->
                                <div *ngFor="let queries of pack_data?.queries | keyvalue" class="kt-portlet__body"
                                  style="padding: 0px;">

                                  <!--begin::Accordion-->
                                  <div class="card right-conf-card" style="margin-bottom: 0.3rem;">
                                    <div class="collapsed style-accordion-background" data-toggle="collapse"
                                      data-skin="dark" attr.data-target="#{{pack_data.name}}-query-{{queries.value.id}}"
                                      data-placement="top" title="{{queries.value.name}}">
                                      {{ queries.value.name }}
                                      <a [routerLink]="['/packs/',queries.value.id,'edit']"
                                        class="query_edit" data-skin="dark" data-toggle="kt-tooltip"
                                        data-placement="top" title="Edit Query">
                                        <img class="pull-right" src="./assets/media/icons/edit-document.svg" height="24"
                                          width="24" alt="">
                                      </a>
                                    </div>
                                    <div id="{{pack_data.name}}-query-{{queries.value.id}}" class="collapse"
                                      attr.data-parent="#accordion-{{pack_data.id}}">
                                      <div class="card-body">
                                        <table class="table table-striped- table-bordered table-hover table-checkable">
                                          <tbody>
                                            <tr>
                                              <td class="head-table">Query</td>
                                              <td class="conf-table-val">
                                                <div>
                                                  <div class="sql hljs">
                                                    <span
                                                      class="hljs-keyword desc-background_packs">{{queries.value.query}}</span>
                                                  </div>
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Interval</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{queries.value.interval}}</div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Platform</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{queries.value.platform}}
                                                  <span class="col-md-1"></span>
                                                  <button (click)="runAdHoc(queries.value.id)" class="btn-success"> Run
                                                    Live </button>
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Description</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs truncate_packs">
                                                  {{queries.value.description}}</div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Version</td>
                                              <td>{{queries.value.version}}</td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Value</td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Packs</td>
                                              <td>
                                                {{queries.value.packs}}
                                                <span class="label">
                                                </span>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Tags</td>
                                              <td>
                                                <tag-input [theme]="'foundation-theme'"
                                                  [placeholder]="'Add tags here...'" [(ngModel)]='queries.value.tags'
                                                  (onAdd)="queries_addTag(queries.value.tags,queries.value.id)"
                                                  (onRemove)="queries_removeTag($event,queries.value.id)"
                                                  [modelAsStrings]="true"></tag-input>
                                              </td>
                                            </tr>
                                          </tbody>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                  <!--end::Accordion-->
                                </div>
                                <!--end::Portlet-->
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                      </div>
                      <!--end:: Content/Packs -->
                      <p *ngIf="packs_count == 0" class="txt-clr">No packs currently associated with this host. Use the
                        tag functionality to associate nodes with packs.</p>
                    </div>
                  </div>
                  <!--End:: Packs -->

                  <!--Begin:: Query -->
                  <div class="kt-portlet">
                    <div class="kt-portlet__body">
                      <h2 style="color:#616C9A">Associated Queries</h2>
                      <!--Begin:: Content/Packs -->
                      <div *ngIf="query_count != 0" class="row">
                        <div class="col-md-4">
                          <!--begin::Portlet-->
                          <div class="kt-portlet no-mar-botom portlet-body_align">
                            <div class="kt-portlet__body" style="padding: 0px;">
                              <!--begin: Search Table -->
                              <div class="">
                                <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
                                  <input type="text" class="form-control" placeholder="Search Queries here..."
                                    id="search_pack_query_name" [(ngModel)]="term">
                                  <span class="kt-input-icon__icon kt-input-icon__icon--left">
                                    <span><i class="la la-search"></i></span>
                                  </span>
                                </div>
                              </div>
                              <!--end: Search Table -->
                              <div class="" style="height: 528px; overflow-x: scroll;margin-bottom:25px;">
                                <div class="">
                                  <!--begin::Notifications-->
                                  <div *ngFor="let query of query_name |filter:term " class="kt-notification conf-div"
                                    id="search_query-name-list" style="cursor:pointer;" data-skin="dark"
                                    data-toggle="kt-tooltip" data-placement="top" title="{{query.name}}">
                                    <div class="kt-notification__item-title list-group" [ngClass]="{'active_data': queryid == query.id}" (click)='getById(query.id)' >
                                    <a data-target="{{query.id}}" class="kt-notification__item conf-link">
                                      <div class="kt-notification__item-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg"
                                          xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px"
                                          viewBox="0 0 24 24" version="1.1" class="kt-svg-icon">
                                          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <rect id="bound" x="0" y="0" width="24" height="24" />
                                            <path
                                              d="M10.5,5 L20.5,5 C21.3284271,5 22,5.67157288 22,6.5 L22,9.5 C22,10.3284271 21.3284271,11 20.5,11 L10.5,11 C9.67157288,11 9,10.3284271 9,9.5 L9,6.5 C9,5.67157288 9.67157288,5 10.5,5 Z M10.5,13 L20.5,13 C21.3284271,13 22,13.6715729 22,14.5 L22,17.5 C22,18.3284271 21.3284271,19 20.5,19 L10.5,19 C9.67157288,19 9,18.3284271 9,17.5 L9,14.5 C9,13.6715729 9.67157288,13 10.5,13 Z"
                                              id="Combined-Shape" fill="#000000" />
                                            <rect id="Rectangle-7-Copy-2" fill="#000000" opacity="0.3" x="2" y="5"
                                              width="5" height="14" rx="1" />
                                          </g>
                                        </svg>
                                      </div>
                                      <div class="kt-notification__item-details">
                                        <div class="kt-notification__item-title" >
                                          {{ query.name }}
                                        </div>
                                      </div>
                                    </a>
                                    </div>
                                  </div>
                                  <!--End::Notifications-->
                                </div>
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                        <!-- <div class="kt-separator"></div> -->
                        <div class="col-md-8 right-content-conf">
                          <!--begin::Portlet-->
                          <div class="right-conf kt-portlet no-mar-botom portlet-body_align__table"
                            id="{{querydata.id}}">
                            <div class="kt-portlet__head">
                              <div class="kt-portlet__head-label">
                                <span class="kt-portlet__head-icon">
                                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                      <rect id="bound" x="0" y="0" width="24" height="24" />
                                      <path
                                        d="M10.5,5 L20.5,5 C21.3284271,5 22,5.67157288 22,6.5 L22,9.5 C22,10.3284271 21.3284271,11 20.5,11 L10.5,11 C9.67157288,11 9,10.3284271 9,9.5 L9,6.5 C9,5.67157288 9.67157288,5 10.5,5 Z M10.5,13 L20.5,13 C21.3284271,13 22,13.6715729 22,14.5 L22,17.5 C22,18.3284271 21.3284271,19 20.5,19 L10.5,19 C9.67157288,19 9,18.3284271 9,17.5 L9,14.5 C9,13.6715729 9.67157288,13 10.5,13 Z"
                                        id="Combined-Shape" fill="#000000" />
                                      <rect id="Rectangle-7-Copy-2" fill="#000000" opacity="0.3" x="2" y="5" width="5"
                                        height="14" rx="1" />
                                    </g>
                                  </svg>
                                </span>
                                <h3 class="kt-portlet__head-title">
                                  {{querydata.name}}
                                </h3>
                              </div>
                              <div class="kt-portlet__head-actions">
                                <a [routerLink]="['/queries/',queryid,'edit']"
                                  class="btn btn-clean btn-sm btn-icon btn-icon-md" data-skin="dark"
                                  data-toggle="kt-tooltip" data-placement="top" title="Edit Query">
                                  <i class="far fa-edit"></i>
                                </a>
                              </div>
                            </div>
                            <div class="kt-portlet__body"
                              style="height: 528px; overflow-x:scroll; padding:1.25rem; margin-bottom:20px;">
                              <div class="accordion accordion-solid" id="accordion-{{querydata.id}}">
                                <!--begin::Portlet-->
                                <div class="kt-portlet__body" style="padding: 0px;">
                                  <!--begin::Accordion-->
                                  <div class="card right-conf-card" style="margin-bottom: 0.3rem;">
                                    <div id="{{querydata.name}}-query-{{querydata.id}}">
                                      <div class="card-body">
                                        <table class="table table-striped- table-bordered table-hover table-checkable">
                                          <tbody>
                                            <tr>
                                              <td class="head-table">Query</td>
                                              <td class="conf-table-val">
                                                <div>
                                                  <div class="sql hljs">
                                                    <span
                                                      class="hljs-keyword desc-background_packs">{{querydata.query}}</span>
                                                  </div>
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Interval</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{querydata.interval}}</div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Platform</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{querydata.platform}}
                                                  <span class="col-md-1"></span>
                                                  <button (click)="runAdHoc(querydata.id)" class="btn-success"> Run Live
                                                  </button>
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Description</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs truncate_packs">
                                                  {{querydata.description}}</div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Version</td>
                                              <td>{{querydata.version}}</td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Value</td>
                                              <td>{{querydata.value}}</td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Packs</td>
                                              <td>
                                                {{querydata.packs}}
                                                <span class="label">
                                                </span>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Tags</td>
                                              <td>
                                                <tag-input [theme]="'foundation-theme'"  [placeholder]="'Add tags here...'" [(ngModel)]='querydata.tags'
                                                  (onAdd)="queries_addTag(querydata.tags,querydata.id)"
                                                  (onRemove)="queries_removeTag($event,querydata.id)"
                                                  [modelAsStrings]="true"></tag-input>
                                              </td>
                                            </tr>
                                          </tbody>
                                        </table>
                                      </div>
                                    </div>

                                  </div>
                                  <!--end::Accordion-->
                                </div>
                                <!--end::Portlet-->
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                      </div>
                      <!--end:: Content/Packs -->
                      <p *ngIf="query_count == 0" class="txt-clr">No queries currently associated with this host. Use
                        the tag functionality to associate nodes with queries.</p>
                    </div>
                  </div>
                  <!--End:: Query -->

                </div>
                <!--end:: Additional/packs/query/tags -->

              </div>
            </div>






          </div>
          <!-- end:: Portlet/tab -->



        </div>
      </div>
    </div>
  </div>
